(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){e.exports=a(33)},27:function(e,t,a){},29:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(16),i=a.n(r),s=(a(27),a(7)),l=a(8),c=a(11),u=a(9),d=a(13),p=(a(29),a(36)),h=a(35),m=a(37),g=a(4),f=a.n(g),b="UQ75LhFcnAv0DtOUwBEA",y="f5nyezNmYF4wvuJqQgNSkg",k="Vv1iS7FJ",E="AbuvUKANJJEZR4nb1zkEXBE",v=function(e,t){return"https://isoline.route.api.here.com/routing/7.2/calculateisoline.json?app_id=".concat(b,"&app_code=").concat(y,"&mode=shortest;pedestrian;traffic:disabled&start=geo!").concat(e[0],",").concat(e[1],"&range=").concat(60*t,"&rangetype=time")},_=function(e){return"https://reverse.geocoder.api.here.com/6.2/reversegeocode.json?prox=".concat(e[0],",").concat(e[1],",250&mode=retrieveAddresses&maxresults=1&gen=9&app_id=").concat(b,"&app_code=").concat(y)},w=a(17),x=a.n(w),z=[{label:"All Alcohol",id:"All_Alcohol",active:!0,background:"#3C4BF1"},{label:"Malt & Wine",id:"Malt_Wine",active:!0,background:"#50D05E"},{label:"Malt, Wine, Liquor",id:"Malt_Wine_Liquor",active:!0,background:"#E265F0"},{label:"Tavern",id:"Tavern",active:!0,background:"#EC3B43"},{label:"Farmer",id:"Farmer",active:!0,background:"#8BFFF2"},{label:"Other",id:"Other",active:!0,background:"yellow"}],C={cameras:{camera1:{type:"perspective"}},sources:{xyz_osm:{type:"MVT",url:"https://xyz.api.here.com/tiles/osmbase/256/all/{z}/{x}/{y}.mvt",max_zoom:16},_boston_alcohol:{type:"GeoJSON",url:"https://xyz.api.here.com/hub/spaces/".concat(k,"/tile/web/{z}_{x}_{y}"),url_params:{access_token:E}}},global:{language:"en",language_text_source:"function() {\n    // Use preferred language label if available\n    return (global.language && feature['name:'+global.language]) || feature.name;\n}\n"},layers:{boston_alcohol:{data:{source:"_boston_alcohol"},draw:{points:{color:"function() {\n    console.log(feature)\n    if (feature.Description === 'All_Alcohol') {\n        return '#3C4BF1';\n    } else if (feature.Description === 'Farmer') {\n        return '#8BFFF2'\n    } else if (feature.Description === 'Malt_Wine') {\n        return '#50D05E'\n    } else if (feature.Description === 'Malt_Wine_Liquor') {\n        return '#E265F0'\n    } else if (feature.Description === 'Other') {\n        return 'yellow'\n    } else if (feature.Description === 'Tavern') {\n        return '#EC3B43'\n    }\n}\n",size:[[13,"7.5px"],[16,"16px"]],order:1e4,interactive:!0,collide:!1}}},places:{data:{source:"xyz_osm"},"city-points":{filter:{kind:"locality",kind_detail:"city",$zoom:{max:18}},draw:{text:{text_source:"global.language_text_source",priority:10,order:999,font:{family:"Lato",fill:"#C3CDD4",stroke:{color:"white",width:4},transform:"uppercase",size:[[4,"15px"],[8,"18px"],[12,"26px"]],buffer:"2px"}}}}},earth:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"white"}}},landuse:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"#E9EEF1"}}},water:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"#DEE1E3"}}},roads:{data:{source:"xyz_osm"},filter:{not:{kind:["path","rail","ferry"]}},draw:{lines:{order:"function() { return feature.sort_rank; }",color:"#C3CDD4",width:8,cap:"round"}},highway:{filter:{kind:"highway"},draw:{lines:{order:"function() { return feature.sort_rank; }",color:"#D3DCE1",width:[[5,5e3],[8,800],[10,200],[12,100],[14,40],[18,20]],outline:{color:"#EEEEEE",width:[[16,0],[18,1.5]]}}}},minor_road:{filter:{kind:"minor_road"},draw:{lines:{order:"function() { return feature.sort_rank; }",color:"#F8FAFB",width:5}}}},buildings:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"#E9EBEB"}},"3d-buildings":{filter:{$zoom:{min:15}},draw:{polygons:{extrude:"function () { return feature.height > 20 || $zoom >= 16; }"}}}}}},F=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleDrag=function(){var e=a.marker.current.leafletElement.getLatLng();a.props.handleMarkerMove([e.lat,e.lng])},a.handleClick=function(e){a.props.handleMarkerMove([e.latlng.lat,e.latlng.lng])},a.marker=o.a.createRef(),a.state={loaded:!1,scene:C,layer:null},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({layer:x.a.leafletLayer({scene:this.state.scene})},function(){e.state.layer.scene.subscribe({load:function(t){e.setState({loaded:!0})}}),e.state.layer.addTo(e.map.leafletElement)})}},{key:"componentDidUpdate",value:function(){this.state.loaded&&(this.state.layer.scene.config.sources._boston_alcohol.url="https://xyz.api.here.com/hub/spaces/".concat(k,"/tile/web/{z}_{x}_{y}?tags=")+this.props.filterTags.join(","),this.state.layer.scene.updateConfig(),console.log(this.state.layer.scene.config.sources._boston_alcohol.url))}},{key:"render",value:function(){var e=this,t=new f.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});return console.log(this.props.filterTags),o.a.createElement(p.a,{ref:function(t){e.map=t},center:this.props.center,zoom:this.props.zoom,zoomControl:!1,onClick:this.handleClick},this.props.markerPosition.length&&o.a.createElement(h.a,{position:this.props.markerPosition,draggable:!0,onDragEnd:this.handleDrag,ref:this.marker,icon:t}),this.props.polygon.length&&o.a.createElement(m.a,{positions:this.props.polygon,color:"#FF8281"}))}}]),t}(o.a.Component),D=a(21),M=a(20),A=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){fetch("https://xyz.api.here.com/hub/spaces/PaLBoFL4/search?access_token=AbuvUKANJJEZR4nb1zkEXBE&tags=").then(function(e){return e.json()}).then(function(e){a.setState({points:e})})},a.updatePolygon=function(){fetch(v(a.state.markerPosition,a.state.range)).then(function(e){return e.json()}).then(function(e){if(e.hasOwnProperty("response")){var t=Object(M.polygon)([e.response.isoline[0].component[0].shape.map(function(e){return[Number(e.split(",")[1]),Number(e.split(",")[0])]})]),n=Object(D.a)(a.state.points,t).features.map(function(e){return e.properties.Index});a.setState({filterTags:n,polygon:e.response.isoline[0].component[0].shape.map(function(e){return[e.split(",")[0],e.split(",")[1]]})})}else a.setState({polygon:[],filterTags:""})})},a.updateAddressText=function(){fetch(_(a.state.markerPosition)).then(function(e){return e.json()}).then(function(e){console.log(e);var t=e.Response.View[0].Result[0].Location.Address;console.log(t),a.setState({address:"".concat(void 0!==t.HouseNumber?t.HouseNumber:"","  ").concat(void 0!==t.Street?t.Street:""," ").concat(t.City)})})},a.handleMarkerMove=function(e){a.setState({markerPosition:e},function(){a.updatePolygon(),a.updateAddressText()})},a.handleSlide=function(e){a.setState({range:e.target.value},function(){a.updatePolygon()})},a.handleClearMarker=function(){a.setState({markerPosition:[]},function(){a.updatePolygon()})},a.handleCategoryFilter=function(e){console.log(e.target);var t=a.state.categories.slice();a.setState({categories:t.map(function(t){return t.id===e.target.id&&(t.active=!t.active),t})})},a.state={name:"Seattle, WA",startCoordinates:[42.35999762427866,-71.05780662703944],polygon:[],markerPosition:[],filterTags:"",zoom:14,range:20,address:"",categories:z},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"app"},o.a.createElement("div",{className:"sidebar"},o.a.createElement("h1",null,"Boston Liquor Licenses \ud83c\udf7b"),o.a.createElement("p",null,"List of establishments with liqour licenses in Boston, MA from 2016."),o.a.createElement("h2",null,"Establishment type"),this.state.categories.map(function(e,t){return o.a.createElement("div",{className:"line-parent",key:t},o.a.createElement("div",{className:"line",id:"".concat(e.id,"-label"),style:{background:e.background}}),e.label)}),o.a.createElement("h2",null,"Explore establishments in walking distance"),!this.state.markerPosition.length&&o.a.createElement("p",null,"Click the map to add a draggable marker"),this.state.markerPosition.length&&o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("input",{type:"range",value:this.state.range,min:"1",max:"60",onChange:this.handleSlide}),this.state.range," minutes"),o.a.createElement("p",null,"Within a ",o.a.createElement("strong",null,this.state.range)," minute walk of ",o.a.createElement("strong",null,this.state.address),", there are ",o.a.createElement("strong",null,this.state.filterTags.length)," establishments that serve liquor."),o.a.createElement("button",{onClick:this.handleClearMarker},"Clear Isoline Filter")),o.a.createElement("a",{id:"link",href:"https://here.xyz"},"Get mappy with HERE XYZ")),o.a.createElement("div",{className:"map-grid"},o.a.createElement(F,{center:this.state.startCoordinates,zoom:this.state.zoom,handleMarkerMove:this.handleMarkerMove,polygon:this.state.polygon,filterTags:this.state.filterTags.length>0?this.state.filterTags:[],markerPosition:this.state.markerPosition})))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.64d7e23f.chunk.js.map