(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){e.exports=a(33)},27:function(e,t,a){},29:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(16),s=a.n(r),i=(a(27),a(7)),l=a(8),c=a(11),u=a(9),d=a(13),p=(a(29),a(36)),h=a(35),m=a(37),g=a(17),f=a.n(g),y={cameras:{camera1:{type:"perspective"}},sources:{xyz_osm:{type:"MVT",url:"https://xyz.api.here.com/tiles/osmbase/256/all/{z}/{x}/{y}.mvt",max_zoom:16},_boston_alcohol:{type:"GeoJSON",url:"https://xyz.api.here.com/hub/spaces/eNy2n73F/tile/web/{z}_{x}_{y}",url_params:{access_token:"AbuvUKANJJEZR4nb1zkEXBE"}}},global:{language:"en",language_text_source:"function() {\n    // Use preferred language label if available\n    return (global.language && feature['name:'+global.language]) || feature.name;\n}\n"},layers:{boston_alcohol:{data:{source:"_boston_alcohol"},draw:{points:{color:"blue",size:[[13,"7.5px"],[16,"16px"]],order:1e4,interactive:!0,collide:!1}}},places:{data:{source:"xyz_osm"},"city-points":{filter:{kind:"locality",kind_detail:"city",$zoom:{max:18}},draw:{text:{text_source:"global.language_text_source",priority:10,order:999,font:{family:"Roboto Mono",fill:"#C3CDD4",stroke:{color:"white",width:4},transform:"uppercase",size:[[4,"15px"],[8,"18px"],[12,"26px"]],buffer:"2px"}}}}},earth:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"white"}}},landuse:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"#E9EEF1"}}},water:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"#C3CDD4"}}},roads:{data:{source:"xyz_osm"},filter:{not:{kind:["path","rail","ferry"]}},draw:{lines:{order:"function() { return feature.sort_rank; }",color:"#C3CDD4",width:8,cap:"round"}},highway:{filter:{kind:"highway"},draw:{lines:{order:"function() { return feature.sort_rank; }",color:"#D3DCE1",width:[[5,5e3],[8,800],[10,200],[12,100],[14,40],[18,20]],outline:{color:"#EEEEEE",width:[[16,0],[18,1.5]]}}}},minor_road:{filter:{kind:"minor_road"},draw:{lines:{order:"function() { return feature.sort_rank; }",color:"#F8FAFB",width:5}}}},buildings:{data:{source:"xyz_osm"},draw:{polygons:{order:"function() { return feature.sort_rank; }",color:"#E9EBEB"}},"3d-buildings":{filter:{$zoom:{min:15}},draw:{polygons:{extrude:"function () { return feature.height > 20 || $zoom >= 16; }"}}}}}},b=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleDrag=function(){var e=a.marker.current.leafletElement.getLatLng();a.props.handleMarkerMove([e.lat,e.lng])},a.handleClick=function(e){a.props.handleMarkerMove([e.latlng.lat,e.latlng.lng])},a.marker=o.a.createRef(),a.state={loaded:!1,scene:y,layer:null},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({layer:f.a.leafletLayer({scene:this.state.scene})},function(){e.state.layer.scene.subscribe({load:function(t){e.setState({loaded:!0})}}),e.state.layer.addTo(e.map.leafletElement)})}},{key:"componentDidUpdate",value:function(){var e=this.props.filterTags.ids.join(",")+"+"+this.props.filterTags.categories.join("+");this.state.loaded&&(this.state.layer.scene.config.sources._boston_alcohol.url="https://xyz.api.here.com/hub/spaces/PaLBoFL4/tile/web/{z}_{x}_{y}?tags="+e,this.state.layer.scene.updateConfig(),console.log(this.state.layer.scene.config.sources._boston_alcohol.url))}},{key:"render",value:function(){var e=this;return console.log(this.props.filterTags),o.a.createElement(p.a,{ref:function(t){e.map=t},center:this.props.center,zoom:this.props.zoom,zoomControl:!1,onClick:this.handleClick},this.props.markerPosition.length&&o.a.createElement(h.a,{position:this.props.markerPosition,draggable:!0,onDragEnd:this.handleDrag,ref:this.marker}),this.props.polygon.length&&o.a.createElement(m.a,{positions:this.props.polygon}))}}]),t}(o.a.Component),v="UQ75LhFcnAv0DtOUwBEA",k="f5nyezNmYF4wvuJqQgNSkg",E=function(e,t){return"https://isoline.route.api.here.com/routing/7.2/calculateisoline.json?app_id=".concat(v,"&app_code=").concat(k,"&mode=shortest;pedestrian;traffic:disabled&start=geo!").concat(e[0],",").concat(e[1],"&range=").concat(60*t,"&rangetype=time")},_=function(e){return"https://reverse.geocoder.api.here.com/6.2/reversegeocode.json?prox=".concat(e[0],",").concat(e[1],",250&mode=retrieveAddresses&maxresults=1&gen=9&app_id=").concat(v,"&app_code=").concat(k)},w=a(21),x=a(20),z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){fetch("https://xyz.api.here.com/hub/spaces/PaLBoFL4/search?access_token=AbuvUKANJJEZR4nb1zkEXBE&tags=").then(function(e){return e.json()}).then(function(e){a.setState({points:e})})},a.updatePolygon=function(){fetch(E(a.state.markerPosition,a.state.range)).then(function(e){return e.json()}).then(function(e){if(e.hasOwnProperty("response")){var t=Object(x.polygon)([e.response.isoline[0].component[0].shape.map(function(e){return[Number(e.split(",")[1]),Number(e.split(",")[0])]})]),n=Object(w.a)(a.state.points,t).features.map(function(e){return e.properties.Index});a.setState({filterTags:n,polygon:e.response.isoline[0].component[0].shape.map(function(e){return[e.split(",")[0],e.split(",")[1]]})})}else a.setState({polygon:[],filterTags:""})})},a.updateAddressText=function(){fetch(_(a.state.markerPosition)).then(function(e){return e.json()}).then(function(e){console.log(e);var t=e.Response.View[0].Result[0].Location.Address;console.log(t),a.setState({address:"".concat(void 0!==t.HouseNumber?t.HouseNumber:"","  ").concat(void 0!==t.Street?t.Street:""," ").concat(t.City)})})},a.handleMarkerMove=function(e){a.setState({markerPosition:e},function(){a.updatePolygon(),a.updateAddressText()})},a.handleSlide=function(e){a.setState({range:e.target.value},function(){a.updatePolygon()})},a.handleClearMarker=function(){a.setState({markerPosition:[]},function(){a.updatePolygon()})},a.handleCategoryFilter=function(e){console.log(e.target);var t=a.state.categories.slice();a.setState({categories:t.map(function(t){return t.id===e.target.id&&(t.active=!t.active),t})})},a.state={name:"Seattle, WA",startCoordinates:[42.362451,-71.058466],polygon:[],markerPosition:[],filterTags:"",zoom:14,options:{type:"distance",range:1e3,mode:"car",traffic:"disabled",style:"reduced.night"},range:20,address:"",categories:[{label:"All Alcohol",id:"all_alcohol",active:!0},{label:"Farmer",id:"farmer",active:!0},{label:"Malt & Wine",id:"malt_&_wine",active:!0},{label:"Malt, Wine, Liquor",id:"malt,_wine,_liquor",active:!0},{label:"Other",id:"other",active:!0},{label:"Tavern",id:"tavern",active:!0}]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"app"},o.a.createElement("div",{className:"sidebar"},o.a.createElement("h3",null,"Boston Liqour Licenses"),o.a.createElement("p",null,"List of establishments with liqour licenses in the city of Boston, Massachusetts from 2016."),o.a.createElement("h4",null,"Filter by type:"),this.state.categories.map(function(t,a){return o.a.createElement("div",{key:a},o.a.createElement("input",{onChange:e.handleCategoryFilter,type:"checkbox",name:"type",id:t.id,checked:t.active}),o.a.createElement("label",{htmlFor:t.id},o.a.createElement("div",{className:"line",id:"".concat(t.id,"-label")}),t.label))}),o.a.createElement("h4",null,"Explore establishments in walking distance"),o.a.createElement("p",null,"Click the map to add a draggable marker"),this.state.markerPosition.length&&o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("input",{type:"range",value:this.state.range,min:"1",max:"60",onChange:this.handleSlide}),this.state.range," minutes"),o.a.createElement("button",{onClick:this.handleClearMarker},"Clear Marker"),o.a.createElement("p",null,"Within a ",o.a.createElement("strong",null,this.state.range)," minute walk of ",o.a.createElement("strong",null,this.state.address),", there are ",o.a.createElement("strong",null,this.state.filterTags.length)," establishments that serve liquor."))),o.a.createElement("div",{className:"map-grid"},o.a.createElement(b,{center:this.state.startCoordinates,zoom:this.state.zoom,options:this.state.options,handleMarkerMove:this.handleMarkerMove,polygon:this.state.polygon,filterTags:{ids:this.state.filterTags.length>0?this.state.filterTags:[],categories:this.state.categories.filter(function(e){return e.active}).map(function(e){return e.id})},markerPosition:this.state.markerPosition})))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.5c04acc9.chunk.js.map