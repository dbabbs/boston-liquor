{"version":3,"sources":["here.js","config.js","SCENE.js","MapContainer.js","App.js","serviceWorker.js","index.js"],"names":["hereCredentials","xyz","hereIsolineUrl","coords","range","concat","hereReverseGeocodeUrl","coordinates","categories","label","id","active","background","SCENE","cameras","camera1","type","sources","xyz_osm","url","max_zoom","_boston_alcohol","url_params","access_token","global","language","language_text_source","layers","boston_alcohol","data","source","draw","points","color","size","order","interactive","collide","places","city-points","filter","kind","kind_detail","$zoom","max","text","text_source","priority","font","family","fill","stroke","width","transform","buffer","earth","polygons","landuse","water","roads","not","lines","cap","highway","outline","minor_road","buildings","3d-buildings","min","extrude","MapContainer","_React$Component","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleMapHover","evt","feature","leaflet_event","latlng","cat","properties","setState","popupPosition","lat","lng","popupHtml","react_default","a","createElement","undefined","split","join","componentDidMount","layer","Tangram","leafletLayer","scene","state","events","hover","subscribe","load","loaded","addTo","map","leafletElement","handleDrag","marker","current","getLatLng","handleMarkerMove","handleClick","React","createRef","inherits","createClass","key","value","config","filterTags","updateConfig","_this2","greenIcon","L","Icon","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","Map","ref","center","zoom","zoomControl","onClick","markerPosition","length","Marker","position","draggable","onDragEnd","icon","polygon","Polygon","positions","Popup","className","closeButton","Component","App","updatePolygon","fetch","then","res","json","hasOwnProperty","turfPoly","response","isoline","component","shape","x","Number","tags","pointsWithinPolygon","features","Index","updateAddressText","address","Response","View","Result","Location","Address","HouseNumber","Street","City","handleSlide","target","handleClearMarker","handleEscapeKey","keyCode","handleCategoryFilter","console","log","copy","slice","c","document","onkeydown","name","startCoordinates","i","style","onChange","href","MapContainer_MapContainer","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.e64da9d3.chunk.js","sourcesContent":["const hereCredentials = {\n   id: 'UQ75LhFcnAv0DtOUwBEA',\n   code: 'f5nyezNmYF4wvuJqQgNSkg'\n}\n\nconst xyz = {\n   space: 'Vv1iS7FJ',\n   token: 'AbuvUKANJJEZR4nb1zkEXBE'\n}\n\nconst hereIsolineUrl = (coords, range) => `https://isoline.route.api.here.com/routing/7.2/calculateisoline.json?app_id=${hereCredentials.id}&app_code=${hereCredentials.code}&mode=shortest;pedestrian;traffic:disabled&start=geo!${coords[0]},${coords[1]}&range=${range * 60}&rangetype=time`\n\nconst maxIsolineRangeLookup = {\n   time: 5000,\n   distance: 80000\n}\n\nconst hereGeocoderUrl = (query) => `https://geocoder.api.here.com/6.2/geocode.json?app_id=${hereCredentials.id}&app_code=${hereCredentials.code}&searchtext=${query}`;\n\nconst hereReverseGeocodeUrl = (coordinates) => `https://reverse.geocoder.api.here.com/6.2/reversegeocode.json?prox=${coordinates[0]},${coordinates[1]},250&mode=retrieveAddresses&maxresults=1&gen=9&app_id=${hereCredentials.id}&app_code=${hereCredentials.code}`;\n\nexport {\n   hereCredentials,\n   xyz,\n   hereIsolineUrl,\n   maxIsolineRangeLookup,\n   hereGeocoderUrl,\n   hereReverseGeocodeUrl\n}\n","const categories = [\n   {\n      label: 'All Alcohol',\n      id: 'All_Alcohol',\n      active: true,\n      background: '#3C4BF1'\n   },\n   {\n      label: 'Malt & Wine',\n      id: 'Malt_Wine',\n      active: true,\n      background: '#50D05E'\n   },\n   {\n      label: 'Malt, Wine, Liquor',\n      id: 'Malt_Wine_Liquor',\n      active: true,\n      background: '#E265F0'\n   },\n   {\n      label: 'Tavern',\n      id: 'Tavern',\n      active: true,\n      background: '#EC3B43'\n   },\n   {\n      label: 'Farmer',\n      id: 'Farmer',\n      active: true,\n      background: '#8BFFF2'\n   },\n   {\n      label: 'Other',\n      id: 'Other',\n      active: true,\n      background: 'yellow'\n   }\n]\n\nexport { categories };\n","import { xyz } from './here.js';\nimport { categories } from './config';\nconst SCENE = {\n\t\"cameras\": {\n\t\t\"camera1\": {\n\t\t\t\"type\": \"perspective\"\n\t\t}\n\t},\n\t\"sources\": {\n\t\t\"xyz_osm\": {\n\t\t\t\"type\": \"MVT\",\n\t\t\t\"url\": \"https://xyz.api.here.com/tiles/osmbase/256/all/{z}/{x}/{y}.mvt\",\n\t\t\t\"max_zoom\": 16\n\t\t},\n\t\t\"_boston_alcohol\": {\n\t\t\t\"type\": \"GeoJSON\",\n\t\t\t\"url\": `https://xyz.api.here.com/hub/spaces/${xyz.space}/tile/web/{z}_{x}_{y}`,\n\t\t\t\"url_params\": {\n\t\t\t\t\"access_token\": xyz.token\n\t\t\t}\n\t\t}\n\t},\n\t\"global\": {\n\t\t\"language\": \"en\",\n\t\t\"language_text_source\": \"function() {\\n    // Use preferred language label if available\\n    return (global.language && feature['name:'+global.language]) || feature.name;\\n}\\n\"\n\t},\n\t\"layers\": {\n\t\t\"boston_alcohol\": {\n\t\t\t\"data\": {\n\t\t\t\t\"source\": \"_boston_alcohol\"\n\t\t\t},\n\t\t\t\"draw\": {\n\t\t\t\t\"points\": {\n\t\t\t\t\t\"color\": \"function() {\\n     if (feature.Description === 'All_Alcohol') {\\n        return '#3C4BF1';\\n    } else if (feature.Description === 'Farmer') {\\n        return '#8BFFF2'\\n    } else if (feature.Description === 'Malt_Wine') {\\n        return '#50D05E'\\n    } else if (feature.Description === 'Malt_Wine_Liquor') {\\n        return '#E265F0'\\n    } else if (feature.Description === 'Other') {\\n        return 'yellow'\\n    } else if (feature.Description === 'Tavern') {\\n        return '#EC3B43'\\n    }\\n}\\n\",\n\t\t\t\t\t\"size\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t13,\n\t\t\t\t\t\t\t\"7.5px\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t16,\n\t\t\t\t\t\t\t\"16px\"\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t\"order\": 10000,\n\t\t\t\t\t\"interactive\": true,\n\t\t\t\t\t\"collide\": false\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"places\": {\n\t\t\t\"data\": {\n\t\t\t\t\"source\": \"xyz_osm\"\n\t\t\t},\n\t\t\t\"city-points\": {\n\t\t\t\t\"filter\": {\n\t\t\t\t\t\"kind\": \"locality\",\n\t\t\t\t\t\"kind_detail\": \"city\",\n\t\t\t\t\t\"$zoom\": {\n\t\t\t\t\t\t\"max\": 18\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"draw\": {\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"text_source\": \"global.language_text_source\",\n\t\t\t\t\t\t\"priority\": 10,\n\t\t\t\t\t\t\"order\": 999,\n\t\t\t\t\t\t\"font\": {\n\t\t\t\t\t\t\t\"family\": \"Lato\",\n\t\t\t\t\t\t\t\"fill\": \"#C3CDD4\",\n\t\t\t\t\t\t\t\"stroke\": {\n\t\t\t\t\t\t\t\t\"color\": \"white\",\n\t\t\t\t\t\t\t\t\"width\": 4\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"transform\": \"uppercase\",\n\t\t\t\t\t\t\t\"size\": [\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t4,\n\t\t\t\t\t\t\t\t\t\"15px\"\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t8,\n\t\t\t\t\t\t\t\t\t\"18px\"\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t12,\n\t\t\t\t\t\t\t\t\t\"26px\"\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"buffer\": \"2px\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"earth\": {\n\t\t\t\"data\": {\n\t\t\t\t\"source\": \"xyz_osm\"\n\t\t\t},\n\t\t\t\"draw\": {\n\t\t\t\t\"polygons\": {\n\t\t\t\t\t\"order\": \"function() { return feature.sort_rank; }\",\n\t\t\t\t\t\"color\": \"white\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"landuse\": {\n\t\t\t\"data\": {\n\t\t\t\t\"source\": \"xyz_osm\"\n\t\t\t},\n\t\t\t\"draw\": {\n\t\t\t\t\"polygons\": {\n\t\t\t\t\t\"order\": \"function() { return feature.sort_rank; }\",\n\t\t\t\t\t\"color\": \"#E9EEF1\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"water\": {\n\t\t\t\"data\": {\n\t\t\t\t\"source\": \"xyz_osm\"\n\t\t\t},\n\t\t\t\"draw\": {\n\t\t\t\t\"polygons\": {\n\t\t\t\t\t\"order\": \"function() { return feature.sort_rank; }\",\n\t\t\t\t\t\"color\": \"#DEE1E3\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"roads\": {\n\t\t\t\"data\": {\n\t\t\t\t\"source\": \"xyz_osm\"\n\t\t\t},\n\t\t\t\"filter\": {\n\t\t\t\t\"not\": {\n\t\t\t\t\t\"kind\": [\n\t\t\t\t\t\t\"path\",\n\t\t\t\t\t\t\"rail\",\n\t\t\t\t\t\t\"ferry\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"draw\": {\n\t\t\t\t\"lines\": {\n\t\t\t\t\t\"order\": \"function() { return feature.sort_rank; }\",\n\t\t\t\t\t\"color\": \"#C3CDD4\",\n\t\t\t\t\t\"width\": 8,\n\t\t\t\t\t\"cap\": \"round\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"highway\": {\n\t\t\t\t\"filter\": {\n\t\t\t\t\t\"kind\": \"highway\"\n\t\t\t\t},\n\t\t\t\t\"draw\": {\n\t\t\t\t\t\"lines\": {\n\t\t\t\t\t\t\"order\": \"function() { return feature.sort_rank; }\",\n\t\t\t\t\t\t\"color\": \"#D3DCE1\",\n\t\t\t\t\t\t\"width\": [\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t5,\n\t\t\t\t\t\t\t\t5000\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t8,\n\t\t\t\t\t\t\t\t800\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t10,\n\t\t\t\t\t\t\t\t200\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t12,\n\t\t\t\t\t\t\t\t100\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t14,\n\t\t\t\t\t\t\t\t40\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t18,\n\t\t\t\t\t\t\t\t20\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"outline\": {\n\t\t\t\t\t\t\t\"color\": \"#EEEEEE\",\n\t\t\t\t\t\t\t\"width\": [\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t16,\n\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t18,\n\t\t\t\t\t\t\t\t\t1.5\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"minor_road\": {\n\t\t\t\t\"filter\": {\n\t\t\t\t\t\"kind\": \"minor_road\"\n\t\t\t\t},\n\t\t\t\t\"draw\": {\n\t\t\t\t\t\"lines\": {\n\t\t\t\t\t\t\"order\": \"function() { return feature.sort_rank; }\",\n\t\t\t\t\t\t\"color\": \"#F8FAFB\",\n\t\t\t\t\t\t\"width\": 5\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"buildings\": {\n\t\t\t\"data\": {\n\t\t\t\t\"source\": \"xyz_osm\"\n\t\t\t},\n\t\t\t\"draw\": {\n\t\t\t\t\"polygons\": {\n\t\t\t\t\t\"order\": \"function() { return feature.sort_rank; }\",\n\t\t\t\t\t\"color\": \"#E9EBEB\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"3d-buildings\": {\n\t\t\t\t\"filter\": {\n\t\t\t\t\t\"$zoom\": {\n\t\t\t\t\t\t\"min\": 15\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"draw\": {\n\t\t\t\t\t\"polygons\": {\n\t\t\t\t\t\t\"extrude\": \"function () { return feature.height > 20 || $zoom >= 16; }\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport default SCENE;\n","import React from 'react';\nimport { Map, Marker, Polygon, Popup } from 'react-leaflet';\nimport L from 'leaflet';\nimport { xyz } from './here'\nimport Tangram from 'tangram';\n\nimport SCENE from './SCENE'\n\nexport class MapContainer extends React.Component {\n\n   constructor(props) {\n      super(props);\n      this.marker = React.createRef();\n\n      this.state = {\n         loaded: false,\n         scene: SCENE,\n         layer: null,\n         popupPosition: [],\n         popupHtml: 'Hello there'\n      }\n   }\n\n   handleMapHover = (evt) => {\n      if (evt.feature) {\n         const coordinates = evt.leaflet_event.latlng;\n\n         const cat = evt.feature.properties['Description'];\n         this.setState({\n            popupPosition: [coordinates.lat, coordinates.lng],\n            popupHtml: (<div>\n                           <h3>{evt.feature.properties['Business Name']}</h3>\n                           <div>Closes at <strong>{evt.feature.properties['Closing']}</strong></div>\n                           {\n                              evt.feature.properties['Capacity'] !== undefined &&\n                              <div>Capacity of <strong>{evt.feature.properties['Capacity']}</strong></div>\n                           }\n                           <div>Located at <strong>{evt.feature.properties['Address']}</strong></div>\n                           {\n                              cat === 'All_Alcohol' || cat === 'Malt_Wine' || cat === 'Malt_Wine_Liquor'\n                              ?\n                              <div>Serves <strong>{cat.split('_').join(' ')}</strong></div>\n                              :\n                              <div>Category of <strong>{cat}</strong></div>\n                           }\n                        </div>\n                       )\n         })\n      } else {\n         this.setState({\n            popupPosition: [],\n            popupHtml: ''\n         })\n      }\n   }\n\n\n   componentDidMount = () => {\n      this.setState({\n         layer: Tangram.leafletLayer({\n            scene: this.state.scene,\n            events: {\n               hover: this.handleMapHover\n            }\n         })\n      }, () => {\n         this.state.layer.scene.subscribe({\n            load: (scene) => {\n               this.setState({\n                  loaded: true\n               })\n            }\n         })\n         this.state.layer.addTo(this.map.leafletElement);\n      })\n   }\n\n   componentDidUpdate() {\n      if (this.state.loaded) {\n         this.state.layer.scene.config.sources._boston_alcohol.url = `https://xyz.api.here.com/hub/spaces/${xyz.space}/tile/web/{z}_{x}_{y}?tags=` + this.props.filterTags.join(',');\n         this.state.layer.scene.updateConfig()\n\n      }\n   }\n\n   handleDrag = () => {\n      const coordinates = this.marker.current.leafletElement.getLatLng();\n      this.props.handleMarkerMove([coordinates.lat, coordinates.lng]);\n   }\n\n   handleClick = (evt) => {\n      this.props.handleMarkerMove([evt.latlng.lat, evt.latlng.lng])\n   }\n\n   render() {\n      var greenIcon = new L.Icon({\n         iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',\n         shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\n         iconSize: [25, 41],\n         iconAnchor: [12, 41],\n         popupAnchor: [1, -34],\n         shadowSize: [41, 41]\n      });\n      return (\n            <Map\n               ref={(ref) => { this.map = ref }}\n               center={this.props.center}\n               zoom={this.props.zoom}\n               zoomControl={false}\n               onClick={this.handleClick}\n            >\n               {\n                  this.props.markerPosition.length &&\n                  <Marker\n                     position={this.props.markerPosition}\n                     draggable={true}\n                     onDragEnd={this.handleDrag}\n                     ref={this.marker}\n                     icon={greenIcon}\n                  />\n               }\n               {\n                  this.props.polygon.length &&\n                  <Polygon\n                     positions={this.props.polygon}\n                     color=\"#FF8281\"\n                  />\n               }\n               {\n                  this.state.popupPosition.length &&\n                  <Popup\n                     position={this.state.popupPosition}\n                     className=\"custom\"\n                     closeButton={false}\n                  >\n                     {this.state.popupHtml}\n                  </Popup>\n               }\n            </Map>\n      )\n   }\n}\n","import React from 'react';\nimport './App.css';\nimport { MapContainer } from './MapContainer';\nimport { hereIsolineUrl, hereReverseGeocodeUrl } from './here';\n\nimport pointsWithinPolygon from '@turf/points-within-polygon';\nimport {polygon} from '@turf/helpers'\nimport { categories } from './config.js'\n\nclass App extends React.Component {\n\n   constructor(props) {\n      super(props);\n      this.state = {\n         name: 'Seattle, WA',\n         startCoordinates: [42.35999762427866, -71.05780662703944],\n         polygon: [],\n         markerPosition: [],\n         filterTags: '',\n         zoom: 14,\n         range: 20,\n         address: '',\n         categories: categories\n      }\n   }\n\n\n\n\n   updatePolygon = () => {\n      fetch(hereIsolineUrl(this.state.markerPosition, this.state.range))\n      .then(res => res.json())\n      .then(res => {\n         if (res.hasOwnProperty('response')) {\n            const turfPoly = polygon([res.response.isoline[0].component[0].shape.map(x => [Number(x.split(',')[1]), Number(x.split(',')[0])])]);\n\n            const within = pointsWithinPolygon(this.state.points, turfPoly);\n\n            const tags = within.features.map(feature => feature.properties.Index);\n\n            this.setState({\n               filterTags: tags,\n               polygon: res.response.isoline[0].component[0].shape.map(x => [x.split(',')[0], x.split(',')[1]])\n            })\n         } else {\n            this.setState({\n               polygon: [],\n               filterTags: ''\n            })\n         }\n      });\n   }\n\n   updateAddressText = () => {\n      fetch(hereReverseGeocodeUrl(this.state.markerPosition))\n      .then(res => res.json())\n      .then(res => {\n         const address = res.Response.View[0].Result[0].Location.Address;\n         this.setState({\n            address: `${address.HouseNumber !== undefined ? address.HouseNumber : ''}  ${address.Street !== undefined ? address.Street : ''} ${address.City}`\n         })\n      })\n   }\n\n   handleMarkerMove = (coordinates) => {\n      this.setState({\n         markerPosition: coordinates\n      }, () => {\n         this.updatePolygon();\n         this.updateAddressText();\n      })\n   }\n\n   handleSlide = (evt) => {\n      this.setState({\n         range: evt.target.value\n      },() => {\n         this.updatePolygon();\n      })\n   }\n\n   handleClearMarker = () => {\n      this.setState({\n         markerPosition: [],\n      }, () => {\n         this.updatePolygon();\n      })\n   }\n\n   handleEscapeKey = (evt) => {\n      if (evt.keyCode === 27) {\n         this.handleClearMarker();\n      }\n   }\n\n   handleCategoryFilter = (evt) => {\n      console.log(evt.target);\n      const copy = this.state.categories.slice();\n\n      this.setState({\n         categories: copy.map(c => {\n            if (c.id === evt.target.id) {\n               c.active = !c.active;\n            }\n            return c;\n         })\n      })\n\n   }\n\n   componentDidMount = () => {\n\n      document.onkeydown = this.handleEscapeKey;\n\n      fetch('https://xyz.api.here.com/hub/spaces/PaLBoFL4/search?access_token=AbuvUKANJJEZR4nb1zkEXBE&tags=')\n         .then(res => res.json())\n         .then(res => {\n            this.setState({\n               points: res\n            })\n         });\n   }\n\n   render() {\n      return (\n         <div className=\"app\">\n            <div className=\"sidebar\">\n               <h1>Boston Liquor Licenses üçª</h1>\n               <p>List of establishments with liqour licenses in Boston, MA from 2016.</p>\n               <h2>Establishment type</h2>\n\n               {\n                  this.state.categories.map(\n                     (cat, i) =>\n                     <div className=\"line-parent\" key={i}>\n                           <div className=\"line\" id={`${cat.id}-label`} style={{background: cat.background}}></div>\n                           {cat.label}\n                     </div>\n                  )\n               }\n               <h2>Explore establishments in walking distance</h2>\n               {\n                  this.state.markerPosition.length < 1 &&\n                  <p>Click the map to add a draggable marker to explore establishments.</p>\n               }\n               {\n                  this.state.markerPosition.length > 0 &&\n                  <div>\n                     <div>\n                        <input\n                           type=\"range\"\n                           value={this.state.range}\n                           min=\"1\"\n                           max=\"60\"\n                           onChange={this.handleSlide}\n                        />\n                        {this.state.range}{\" minutes\"}\n                     </div>\n                     <p>Within a <strong>{this.state.range}</strong> minute walk of <strong>{this.state.address}</strong>, there are <strong>{this.state.filterTags.length}</strong> establishments that serve liquor.</p>\n                     <button\n                        onClick={this.handleClearMarker}\n                     >\n                        Clear Isoline Filter\n                     </button>\n                  </div>\n               }\n               <a id=\"link\" href=\"https://here.xyz\">Get mappy with HERE XYZ</a>\n            </div>\n            <div className=\"map-grid\">\n               <MapContainer\n                  center={this.state.startCoordinates}\n                  zoom={this.state.zoom}\n                  handleMarkerMove={this.handleMarkerMove}\n                  polygon={this.state.polygon}\n                  filterTags={this.state.filterTags.length > 0 ? this.state.filterTags : []}\n                  markerPosition={this.state.markerPosition}\n               />\n            </div>\n         </div>\n      );\n   }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}